[0m10:37:16.545827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b463910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b464190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b48a310>]}


============================== 10:37:16.547741 | f5d76458-3232-4d90-bb8d-7d731e8d9c9f ==============================
[0m10:37:16.547741 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:37:16.547962 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None'}
[0m10:37:16.554387 [info ] [MainThread]: dbt version: 1.11.2
[0m10:37:16.554543 [info ] [MainThread]: python version: 3.11.14
[0m10:37:16.554647 [info ] [MainThread]: python path: /Users/kaleab/Desktop/dbt_enpal_assessment/venv/bin/python3.11
[0m10:37:16.554734 [info ] [MainThread]: os info: macOS-26.1-arm64-arm-64bit
[0m10:37:16.581889 [info ] [MainThread]: Using profiles dir at /Users/kaleab/Desktop/dbt_enpal_assessment
[0m10:37:16.582078 [info ] [MainThread]: Using profiles.yml file at /Users/kaleab/Desktop/dbt_enpal_assessment/profiles.yml
[0m10:37:16.582171 [info ] [MainThread]: Using dbt_project.yml file at /Users/kaleab/Desktop/dbt_enpal_assessment/dbt_project.yml
[0m10:37:16.582454 [info ] [MainThread]: adapter type: postgres
[0m10:37:16.582582 [info ] [MainThread]: adapter version: 1.10.0
[0m10:37:16.610485 [info ] [MainThread]: Configuration:
[0m10:37:16.610654 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:37:16.610752 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:37:16.610834 [info ] [MainThread]: Required dependencies:
[0m10:37:16.610957 [debug] [MainThread]: Executing "git --help"
[0m10:37:16.621079 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:37:16.621394 [debug] [MainThread]: STDERR: "b''"
[0m10:37:16.621502 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:37:16.621610 [info ] [MainThread]: Connection:
[0m10:37:16.621716 [info ] [MainThread]:   host: 127.0.0.1
[0m10:37:16.621797 [info ] [MainThread]:   port: 5432
[0m10:37:16.621880 [info ] [MainThread]:   user: admin
[0m10:37:16.621956 [info ] [MainThread]:   database: postgres
[0m10:37:16.622032 [info ] [MainThread]:   schema: public
[0m10:37:16.622108 [info ] [MainThread]:   connect_timeout: 10
[0m10:37:16.622186 [info ] [MainThread]:   role: None
[0m10:37:16.622265 [info ] [MainThread]:   search_path: None
[0m10:37:16.622342 [info ] [MainThread]:   keepalives_idle: 0
[0m10:37:16.622417 [info ] [MainThread]:   sslmode: None
[0m10:37:16.622494 [info ] [MainThread]:   sslcert: None
[0m10:37:16.622569 [info ] [MainThread]:   sslkey: None
[0m10:37:16.622645 [info ] [MainThread]:   sslrootcert: None
[0m10:37:16.622723 [info ] [MainThread]:   application_name: dbt
[0m10:37:16.622802 [info ] [MainThread]:   retries: 1
[0m10:37:16.622989 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:37:16.656508 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:37:16.672722 [debug] [MainThread]: Using postgres connection "debug"
[0m10:37:16.672850 [debug] [MainThread]: On debug: select 1 as id
[0m10:37:16.672934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:16.703406 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m10:37:16.703749 [debug] [MainThread]: On debug: Close
[0m10:37:16.703857 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:37:16.703957 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:37:16.705345 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.18435383, "process_in_blocks": "0", "process_kernel_time": 0.122497, "process_mem_max_rss": "134037504", "process_out_blocks": "0", "process_user_time": 0.48827}
[0m10:37:16.705506 [debug] [MainThread]: Command `dbt debug` succeeded at 10:37:16.705470 after 0.18 seconds
[0m10:37:16.705612 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:37:16.705718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b453990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b19f090>]}
[0m10:37:16.705845 [debug] [MainThread]: Flushing usage events
[0m10:37:17.780108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:17.595903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da0dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da0e890>]}


============================== 11:47:17.597802 | 9533a278-a366-4bde-a471-e19b60df86c0 ==============================
[0m11:47:17.597802 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:47:17.598028 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'static_parser': 'True', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m11:47:17.659033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2ce8d0>]}
[0m11:47:17.675636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae31750>]}
[0m11:47:17.676053 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:47:17.712250 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:47:17.736658 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:47:17.736847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb65890>]}
[0m11:47:18.043976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e969550>]}
[0m11:47:18.063496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m11:47:18.064532 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:47:18.072214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed73c90>]}
[0m11:47:18.072373 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m11:47:18.072480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb81790>]}
[0m11:47:18.073006 [info ] [MainThread]: 
[0m11:47:18.073123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:18.073205 [info ] [MainThread]: 
[0m11:47:18.073349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:47:18.073600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:47:18.092518 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:47:18.092634 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:47:18.092717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:18.120846 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m11:47:18.121288 [debug] [ThreadPool]: On list_postgres: Close
[0m11:47:18.121529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_public_pipedrive_analytics)
[0m11:47:18.121705 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "public_pipedrive_analytics"
"
[0m11:47:18.123371 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m11:47:18.123473 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "create_postgres_public_pipedrive_analytics"} */
create schema if not exists "public_pipedrive_analytics"
[0m11:47:18.123565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:18.129425 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.006 seconds
[0m11:47:18.129708 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m11:47:18.129796 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_pipedrive_analytics"
[0m11:47:18.129870 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: COMMIT
[0m11:47:18.130482 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m11:47:18.130567 [debug] [ThreadPool]: On create_postgres_public_pipedrive_analytics: Close
[0m11:47:18.130894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_public_pipedrive_analytics, now list_postgres_public_pipedrive_analytics)
[0m11:47:18.132654 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m11:47:18.132808 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m11:47:18.132930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:18.140665 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m11:47:18.140977 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m11:47:18.141294 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m11:47:18.142716 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:18.142839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:47:18.142955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:18.150694 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m11:47:18.151094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d981450>]}
[0m11:47:18.151251 [debug] [MainThread]: On master: ROLLBACK
[0m11:47:18.151600 [debug] [MainThread]: On master: COMMIT
[0m11:47:18.151695 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:18.151773 [debug] [MainThread]: On master: COMMIT
[0m11:47:18.152272 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:47:18.152360 [debug] [MainThread]: On master: Close
[0m11:47:18.153369 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m11:47:18.153527 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m11:47:18.153660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m11:47:18.153768 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m11:47:18.156306 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m11:47:18.156541 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m11:47:18.168599 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m11:47:18.168828 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m11:47:18.168936 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m11:47:18.169036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:18.181842 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m11:47:18.184821 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m11:47:18.184935 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m11:47:18.185463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:47:18.189546 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m11:47:18.189659 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m11:47:18.189759 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m11:47:18.191882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:47:18.193841 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m11:47:18.195285 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m11:47:18.195397 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m11:47:18.195795 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m11:47:18.196487 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m11:47:18.197127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9533a278-a366-4bde-a471-e19b60df86c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb07850>]}
[0m11:47:18.197319 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.04s]
[0m11:47:18.197492 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m11:47:18.197892 [debug] [MainThread]: On master: COMMIT
[0m11:47:18.197995 [debug] [MainThread]: Using postgres connection "master"
[0m11:47:18.198075 [debug] [MainThread]: On master: COMMIT
[0m11:47:18.198147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:18.204468 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m11:47:18.204564 [debug] [MainThread]: On master: Close
[0m11:47:18.204675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:18.204750 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m11:47:18.204834 [info ] [MainThread]: 
[0m11:47:18.204925 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m11:47:18.205123 [debug] [MainThread]: Command end result
[0m11:47:18.212057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m11:47:18.212582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m11:47:18.214311 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m11:47:18.214396 [info ] [MainThread]: 
[0m11:47:18.214545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:18.214639 [info ] [MainThread]: 
[0m11:47:18.214736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:47:18.216185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64341444, "process_in_blocks": "0", "process_kernel_time": 0.135865, "process_mem_max_rss": "145883136", "process_out_blocks": "0", "process_user_time": 0.902104}
[0m11:47:18.216340 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:18.216314 after 0.64 seconds
[0m11:47:18.216456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da0e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da0e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979e050>]}
[0m11:47:18.216567 [debug] [MainThread]: Flushing usage events
[0m11:47:18.852179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:31.546485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a03f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cdc90>]}


============================== 12:27:31.548507 | 9aeb7659-cf17-46e6-844a-acb69bdf2add ==============================
[0m12:27:31.548507 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:27:31.548740 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'False', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'printer_width': '80', 'write_json': 'True', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False'}
[0m12:27:31.609026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a78f810>]}
[0m12:27:31.625442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f2850>]}
[0m12:27:31.625867 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:27:31.663002 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:27:31.703003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:31.703254 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/sources.yml
[0m12:27:31.819707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37b810>]}
[0m12:27:31.839036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m12:27:31.839991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:27:31.846918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae40850>]}
[0m12:27:31.847079 [info ] [MainThread]: Found 1 model, 6 sources, 464 macros
[0m12:27:31.847184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae34090>]}
[0m12:27:31.847702 [info ] [MainThread]: 
[0m12:27:31.847826 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:31.847907 [info ] [MainThread]: 
[0m12:27:31.848049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:31.848281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public_pipedrive_analytics'
[0m12:27:31.867400 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:27:31.867534 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:27:31.867636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:31.902318 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m12:27:31.902816 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:27:31.903142 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:27:31.904695 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:31.904836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:27:31.904956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:31.913263 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:27:31.913653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9aeb7659-cf17-46e6-844a-acb69bdf2add', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b612d90>]}
[0m12:27:31.913800 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:31.914109 [debug] [MainThread]: On master: Close
[0m12:27:31.915126 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m12:27:31.915273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.test_model)
[0m12:27:31.915387 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m12:27:31.917772 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m12:27:31.917979 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m12:27:31.918171 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m12:27:31.918476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:31.918561 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m12:27:31.918724 [debug] [MainThread]: Command end result
[0m12:27:31.925417 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m12:27:31.925900 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:27:31.927780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m12:27:31.929253 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.4108844, "process_in_blocks": "0", "process_kernel_time": 0.134862, "process_mem_max_rss": "144195584", "process_out_blocks": "0", "process_user_time": 0.690046}
[0m12:27:31.929401 [debug] [MainThread]: Command `dbt compile` succeeded at 12:27:31.929374 after 0.41 seconds
[0m12:27:31.929510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cdf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e12050>]}
[0m12:27:31.929623 [debug] [MainThread]: Flushing usage events
[0m12:27:32.531648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:37.055094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601410>]}


============================== 12:49:37.057107 | ecc0b5db-12cc-4ac2-baec-af7a538ba09f ==============================
[0m12:49:37.057107 [info ] [MainThread]: Running with dbt=1.11.2
[0m12:49:37.057344 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select stg_activity', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'write_json': 'True', 'introspect': 'True', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m12:49:37.118012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c321dd0>]}
[0m12:49:37.134587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a501d0>]}
[0m12:49:37.135000 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m12:49:37.171193 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m12:49:37.211604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:49:37.211780 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity.sql
[0m12:49:37.282171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8583d0>]}
[0m12:49:37.319750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m12:49:37.320645 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:49:37.328736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c784f50>]}
[0m12:49:37.328901 [info ] [MainThread]: Found 2 models, 6 sources, 464 macros
[0m12:49:37.329007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7bded0>]}
[0m12:49:37.329467 [info ] [MainThread]: 
[0m12:49:37.329577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:37.329659 [info ] [MainThread]: 
[0m12:49:37.329810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:37.330063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:49:37.349503 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:49:37.349640 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:49:37.349726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:37.375529 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m12:49:37.375939 [debug] [ThreadPool]: On list_postgres: Close
[0m12:49:37.377213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m12:49:37.379031 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m12:49:37.379147 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m12:49:37.379241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:37.387574 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m12:49:37.387941 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m12:49:37.388262 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m12:49:37.389764 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.389897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:49:37.390024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:37.398063 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m12:49:37.398404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c506a90>]}
[0m12:49:37.398548 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:37.398844 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.398929 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.399002 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.399490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:49:37.399573 [debug] [MainThread]: On master: Close
[0m12:49:37.400564 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m12:49:37.400712 [info ] [Thread-1 (]: 1 of 1 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m12:49:37.400862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m12:49:37.400983 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m12:49:37.403364 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m12:49:37.403639 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m12:49:37.413638 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m12:49:37.413906 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:49:37.414027 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity"
),

renamed as (
    select
        -- rename and transform columns here
        activity_id,
        type as activity_type_key,
        assigned_to_user as user_id,
        deal_id,
        -- convert 'True'/'False' strings to boolean
        case 
            when done = 'True' then true
            when done = 'False' then false
            else null
        end as is_completed,
        cast(due_to as timestamp) as due_timestamp
    from source
)

select * from renamed
  );
[0m12:49:37.414141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:37.425630 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m12:49:37.427526 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:49:37.427637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m12:49:37.428234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:49:37.432300 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m12:49:37.432412 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:49:37.432506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m12:49:37.433798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:49:37.435596 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m12:49:37.436960 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m12:49:37.437066 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m12:49:37.437930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:49:37.438666 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m12:49:37.439322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc0b5db-12cc-4ac2-baec-af7a538ba09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb78e50>]}
[0m12:49:37.439527 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.04s]
[0m12:49:37.439708 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m12:49:37.440081 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.440175 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:37.440252 [debug] [MainThread]: On master: COMMIT
[0m12:49:37.440323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:37.447153 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m12:49:37.447244 [debug] [MainThread]: On master: Close
[0m12:49:37.447352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:37.447426 [debug] [MainThread]: Connection 'model.enpal_assessment_project.stg_activity' was properly closed.
[0m12:49:37.447507 [info ] [MainThread]: 
[0m12:49:37.447602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m12:49:37.447786 [debug] [MainThread]: Command end result
[0m12:49:37.454950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m12:49:37.455502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m12:49:37.457269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m12:49:37.457358 [info ] [MainThread]: 
[0m12:49:37.457483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:37.457571 [info ] [MainThread]: 
[0m12:49:37.457669 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:49:37.458958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43088293, "process_in_blocks": "0", "process_kernel_time": 0.114335, "process_mem_max_rss": "143523840", "process_out_blocks": "0", "process_user_time": 0.695516}
[0m12:49:37.459089 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:37.459066 after 0.43 seconds
[0m12:49:37.459201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b625bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b625b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024c6110>]}
[0m12:49:37.459306 [debug] [MainThread]: Flushing usage events
[0m12:49:38.108280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:29.902464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d697490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d696790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d71e450>]}


============================== 13:09:29.904417 | 6d13b982-c689-4b7e-93c3-854aa2e8d69a ==============================
[0m13:09:29.904417 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:09:29.904635 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'introspect': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False'}
[0m13:09:29.963416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfde950>]}
[0m13:09:29.979710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4c290>]}
[0m13:09:29.980122 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:09:30.016251 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:09:30.056029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m13:09:30.056210 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m13:09:30.056309 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m13:09:30.056397 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_stages.sql
[0m13:09:30.056491 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/staging/stg_users.sql
[0m13:09:30.129288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7f0fd0>]}
[0m13:09:30.167192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:09:30.168021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:09:30.175903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c4450>]}
[0m13:09:30.176071 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:09:30.176177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e88a8d0>]}
[0m13:09:30.176738 [info ] [MainThread]: 
[0m13:09:30.176849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:30.176929 [info ] [MainThread]: 
[0m13:09:30.177067 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:09:30.178196 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:09:30.197673 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:09:30.197804 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:09:30.197892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:30.225636 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.028 seconds
[0m13:09:30.226086 [debug] [ThreadPool]: On list_postgres: Close
[0m13:09:30.226567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:09:30.228377 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:09:30.228484 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:09:30.228574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:30.236705 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m13:09:30.237102 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:09:30.237419 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:09:30.238890 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:30.239041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:09:30.239167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:30.247346 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:09:30.247733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e85ee50>]}
[0m13:09:30.247878 [debug] [MainThread]: On master: ROLLBACK
[0m13:09:30.248157 [debug] [MainThread]: On master: COMMIT
[0m13:09:30.248246 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:30.248320 [debug] [MainThread]: On master: COMMIT
[0m13:09:30.248775 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:09:30.248861 [debug] [MainThread]: On master: Close
[0m13:09:30.249905 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m13:09:30.250071 [info ] [Thread-1 (]: 1 of 2 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m13:09:30.250225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m13:09:30.250331 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:09:30.252806 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:09:30.253172 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:09:30.263432 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:09:30.263692 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:09:30.263818 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity"
),

renamed as (
    select
        -- rename and transform columns here
        activity_id,
        type as activity_type_key,
        assigned_to_user as user_id,
        deal_id,
        -- convert 'True'/'False' strings to boolean
        case 
            when done = 'True' then true
            when done = 'False' then false
            else null
        end as is_completed,
        cast(due_to as timestamp) as due_timestamp
    from source
)

select * from renamed
  );
[0m13:09:30.263935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:30.274239 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:09:30.276194 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:09:30.276310 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:09:30.276853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:09:30.277734 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:09:30.277837 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:09:30.278565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:09:30.283224 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:09:30.283339 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:09:30.283433 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:09:30.286579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:09:30.289037 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m13:09:30.290475 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:09:30.290589 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m13:09:30.293060 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:09:30.293778 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m13:09:30.294419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edc0190>]}
[0m13:09:30.294619 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.04s]
[0m13:09:30.294793 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:09:30.294916 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m13:09:30.295095 [info ] [Thread-1 (]: 2 of 2 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m13:09:30.295244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.test_model)
[0m13:09:30.295352 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m13:09:30.296196 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m13:09:30.296398 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m13:09:30.302726 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m13:09:30.302934 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:09:30.303039 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m13:09:30.303136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:30.315783 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.013 seconds
[0m13:09:30.317874 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:09:30.317989 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m13:09:30.318547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:09:30.319437 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:09:30.319538 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m13:09:30.320083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:09:30.320477 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:09:30.320574 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:09:30.320660 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:09:30.321837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:09:30.322543 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m13:09:30.323393 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:09:30.323499 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m13:09:30.325904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:09:30.326257 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m13:09:30.326420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d13b982-c689-4b7e-93c3-854aa2e8d69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edaef90>]}
[0m13:09:30.326606 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.03s]
[0m13:09:30.326777 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m13:09:30.327173 [debug] [MainThread]: On master: COMMIT
[0m13:09:30.327269 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:30.327346 [debug] [MainThread]: On master: COMMIT
[0m13:09:30.327417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:30.332636 [debug] [MainThread]: SQL status: COMMIT in 0.005 seconds
[0m13:09:30.332736 [debug] [MainThread]: On master: Close
[0m13:09:30.332858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:30.332932 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m13:09:30.333017 [info ] [MainThread]: 
[0m13:09:30.333113 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:09:30.333341 [debug] [MainThread]: Command end result
[0m13:09:30.340708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:09:30.341226 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:09:30.343078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:09:30.343180 [info ] [MainThread]: 
[0m13:09:30.343299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:30.343389 [info ] [MainThread]: 
[0m13:09:30.343491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:09:30.344902 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.46650213, "process_in_blocks": "0", "process_kernel_time": 0.135325, "process_mem_max_rss": "144261120", "process_out_blocks": "0", "process_user_time": 0.717053}
[0m13:09:30.345044 [debug] [MainThread]: Command `dbt run` succeeded at 13:09:30.345019 after 0.47 seconds
[0m13:09:30.345153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d737c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d737350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045de050>]}
[0m13:09:30.345258 [debug] [MainThread]: Flushing usage events
[0m13:09:31.267597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:17.622506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109786d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bc3d0>]}


============================== 13:16:17.624380 | a0233eae-6bab-4ab4-8ab0-78c923cf26d1 ==============================
[0m13:16:17.624380 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:16:17.624601 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'static_parser': 'True', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m13:16:17.683401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f7390>]}
[0m13:16:17.699760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07810>]}
[0m13:16:17.700187 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:16:17.737743 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:16:17.778035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:16:17.778245 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_activity_types.sql
[0m13:16:17.778366 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_stages.sql
[0m13:16:17.778471 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_users.sql
[0m13:16:17.778573 [debug] [MainThread]: Partial parsing: updated file: enpal_assessment_project://models/staging/stg_deal_changes.sql
[0m13:16:17.852742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa20dd0>]}
[0m13:16:17.890524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:16:17.891492 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:16:17.899748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa6610>]}
[0m13:16:17.899948 [info ] [MainThread]: Found 6 models, 6 sources, 464 macros
[0m13:16:17.900061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab11410>]}
[0m13:16:17.900772 [info ] [MainThread]: 
[0m13:16:17.900915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:17.901001 [info ] [MainThread]: 
[0m13:16:17.901258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:16:17.902859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:16:17.922737 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:16:17.922877 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:16:17.922968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:17.952882 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m13:16:17.953370 [debug] [ThreadPool]: On list_postgres: Close
[0m13:16:17.953860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:16:17.955735 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:16:17.955845 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:16:17.955937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:17.965519 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m13:16:17.965946 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:16:17.966263 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:16:17.967777 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:17.967923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:16:17.968043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:17.976379 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:16:17.976737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5f950>]}
[0m13:16:17.976877 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:17.977239 [debug] [MainThread]: On master: COMMIT
[0m13:16:17.977323 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:17.977396 [debug] [MainThread]: On master: COMMIT
[0m13:16:17.977891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:17.977972 [debug] [MainThread]: On master: Close
[0m13:16:17.979056 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m13:16:17.979207 [info ] [Thread-1 (]: 1 of 6 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m13:16:17.979437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m13:16:17.979562 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:16:17.981995 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:16:17.982230 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:16:17.992578 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:16:17.992858 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:16:17.992985 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity"
),

renamed as (
    select
        -- rename and transform columns here
        activity_id,
        type as activity_type_key,
        assigned_to_user as user_id,
        deal_id,
        -- convert 'True'/'False' strings to boolean
        case 
            when done = 'True' then true
            when done = 'False' then false
            else null
        end as is_completed,
        cast(due_to as timestamp) as due_timestamp
    from source
)

select * from renamed
  );
[0m13:16:17.993114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.003568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:16:18.005562 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:16:18.005682 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:16:18.006240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.007123 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:16:18.007229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:16:18.007766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.012415 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:16:18.012529 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:16:18.012626 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:16:18.013780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.015572 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m13:16:18.016975 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:16:18.017086 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m13:16:18.018589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:16:18.019398 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m13:16:18.020065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90f150>]}
[0m13:16:18.020297 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.04s]
[0m13:16:18.020486 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:16:18.020611 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m13:16:18.020752 [info ] [Thread-1 (]: 2 of 6 START sql view model public_pipedrive_analytics.stg_activity_types ...... [RUN]
[0m13:16:18.020917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m13:16:18.021029 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m13:16:18.022508 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.022739 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m13:16:18.023780 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.023979 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.024089 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity_types"
),

renamed as (
    select
        id as activity_type_id,
        name as activity_type_name,
        case 
            when active = 'Yes' then true
            when active = 'No' then false
            else null
        end as is_active,
        type as activity_type_key
    from source
)

select * from renamed
  );
[0m13:16:18.024190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.034219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:16:18.035180 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.035298 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m13:16:18.035905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:18.036314 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:16:18.036417 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.036506 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:16:18.037227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.037919 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m13:16:18.038116 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:16:18.038232 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m13:16:18.038654 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:16:18.039047 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m13:16:18.039214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae97c50>]}
[0m13:16:18.039392 [info ] [Thread-1 (]: 2 of 6 OK created sql view model public_pipedrive_analytics.stg_activity_types . [[32mCREATE VIEW[0m in 0.02s]
[0m13:16:18.039561 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m13:16:18.039672 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:16:18.039839 [info ] [Thread-1 (]: 3 of 6 START sql view model public_pipedrive_analytics.stg_deal_changes ........ [RUN]
[0m13:16:18.039974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:16:18.040077 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:16:18.040947 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.041149 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:16:18.042277 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.042484 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.042610 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."deal_changes"
),

renamed as (
    select
        deal_id,
        cast(change_time as timestamp) as change_timestamp,
        changed_field_key as field_key,
        new_value
    from source
)

select * from renamed
  );
[0m13:16:18.042723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.051388 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:16:18.052364 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.052494 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:16:18.053014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.053428 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:16:18.053547 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.053659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:16:18.054266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.054983 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m13:16:18.055232 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:16:18.055344 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m13:16:18.055917 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:16:18.056319 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:16:18.056488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae94e50>]}
[0m13:16:18.056672 [info ] [Thread-1 (]: 3 of 6 OK created sql view model public_pipedrive_analytics.stg_deal_changes ... [[32mCREATE VIEW[0m in 0.02s]
[0m13:16:18.056837 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:16:18.056946 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m13:16:18.057112 [info ] [Thread-1 (]: 4 of 6 START sql view model public_pipedrive_analytics.stg_stages .............. [RUN]
[0m13:16:18.057252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m13:16:18.057353 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m13:16:18.058210 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m13:16:18.058436 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m13:16:18.059594 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m13:16:18.059785 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:16:18.059886 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."stages"
),

renamed as (
    select
        stage_id,
        stage_name
    from source
)

select * from renamed
  );
[0m13:16:18.059983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.068683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:16:18.070183 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:16:18.070291 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m13:16:18.070767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.071167 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:16:18.071275 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:16:18.071372 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:16:18.072361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.073115 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m13:16:18.073327 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:16:18.073435 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m13:16:18.073873 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:16:18.074234 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m13:16:18.074398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebc290>]}
[0m13:16:18.074588 [info ] [Thread-1 (]: 4 of 6 OK created sql view model public_pipedrive_analytics.stg_stages ......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:16:18.074752 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m13:16:18.074871 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m13:16:18.075007 [info ] [Thread-1 (]: 5 of 6 START sql view model public_pipedrive_analytics.stg_users ............... [RUN]
[0m13:16:18.075163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m13:16:18.075269 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m13:16:18.076173 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m13:16:18.076377 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m13:16:18.077415 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m13:16:18.077612 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:16:18.077714 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."users"
),

renamed as (
    select
        id as user_id,
        name as user_name,
        email as user_email,
        cast(modified as timestamp) as modified_timestamp
    from source
)

select * from renamed
  );
[0m13:16:18.077813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.085693 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:16:18.086653 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:16:18.086770 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:16:18.087268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.087657 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:16:18.087766 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:16:18.087862 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:16:18.088511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.089257 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m13:16:18.089482 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:16:18.089592 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m13:16:18.090066 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:16:18.090419 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m13:16:18.090573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb0e10>]}
[0m13:16:18.090759 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public_pipedrive_analytics.stg_users .......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:16:18.090924 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m13:16:18.091041 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m13:16:18.091207 [info ] [Thread-1 (]: 6 of 6 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m13:16:18.091345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m13:16:18.091455 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m13:16:18.092302 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m13:16:18.092495 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m13:16:18.099217 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m13:16:18.099452 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:16:18.099559 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m13:16:18.099657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:18.112194 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.012 seconds
[0m13:16:18.114405 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:16:18.114523 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m13:16:18.115028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.115951 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:16:18.116063 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m13:16:18.116507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:18.116942 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:16:18.117050 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:16:18.117148 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:16:18.118424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:18.119864 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m13:16:18.120784 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:16:18.120902 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m13:16:18.122302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:16:18.122678 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m13:16:18.122839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0233eae-6bab-4ab4-8ab0-78c923cf26d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af06c50>]}
[0m13:16:18.123021 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.03s]
[0m13:16:18.123185 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m13:16:18.123581 [debug] [MainThread]: On master: COMMIT
[0m13:16:18.123675 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:18.123755 [debug] [MainThread]: On master: COMMIT
[0m13:16:18.123828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:18.129890 [debug] [MainThread]: SQL status: COMMIT in 0.006 seconds
[0m13:16:18.129994 [debug] [MainThread]: On master: Close
[0m13:16:18.130109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:18.130189 [debug] [MainThread]: Connection 'model.enpal_assessment_project.test_model' was properly closed.
[0m13:16:18.130311 [info ] [MainThread]: 
[0m13:16:18.130407 [info ] [MainThread]: Finished running 1 table model, 5 view models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:16:18.130779 [debug] [MainThread]: Command end result
[0m13:16:18.138374 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:16:18.139024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:16:18.141089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:16:18.141187 [info ] [MainThread]: 
[0m13:16:18.141303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:18.141390 [info ] [MainThread]: 
[0m13:16:18.141489 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:16:18.142939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.54297227, "process_in_blocks": "0", "process_kernel_time": 0.140228, "process_mem_max_rss": "144261120", "process_out_blocks": "0", "process_user_time": 0.75197}
[0m13:16:18.143092 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:18.143066 after 0.54 seconds
[0m13:16:18.143225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c6050>]}
[0m13:16:18.143335 [debug] [MainThread]: Flushing usage events
[0m13:16:18.932114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:06.863384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfb6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfadf90>]}


============================== 13:40:06.865412 | 227d17f5-0bc8-45c3-9011-defdf98d2226 ==============================
[0m13:40:06.865412 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:40:06.865676 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select intermediate.*', 'write_json': 'True', 'version_check': 'True', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:40:06.926068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e019b50>]}
[0m13:40:06.942539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b403550>]}
[0m13:40:06.942976 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:40:06.979951 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:40:07.021723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m13:40:07.021909 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_completed_activities.sql
[0m13:40:07.022008 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/intermediate/int_deal_stage_history.sql
[0m13:40:07.022096 [debug] [MainThread]: Partial parsing: added file: enpal_assessment_project://models/reporting/rep_sales_funnel_monthly.sql
[0m13:40:07.096246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecfcb90>]}
[0m13:40:07.135142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:40:07.136111 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:40:07.144895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e8dd0>]}
[0m13:40:07.145064 [info ] [MainThread]: Found 9 models, 6 sources, 464 macros
[0m13:40:07.145178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1b9350>]}
[0m13:40:07.145783 [info ] [MainThread]: 
[0m13:40:07.145910 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:07.145997 [info ] [MainThread]: 
[0m13:40:07.146141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:07.147311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:40:07.166460 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:40:07.166577 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:40:07.166662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:07.198590 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m13:40:07.199037 [debug] [ThreadPool]: On list_postgres: Close
[0m13:40:07.199555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:40:07.201368 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:40:07.201472 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:40:07.201566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:07.210777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m13:40:07.211203 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:40:07.211522 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:40:07.213181 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:07.213313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:40:07.213432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:07.221645 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m13:40:07.222005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26bc90>]}
[0m13:40:07.222144 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:07.222444 [debug] [MainThread]: On master: COMMIT
[0m13:40:07.222527 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:07.222599 [debug] [MainThread]: On master: COMMIT
[0m13:40:07.223079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:07.223164 [debug] [MainThread]: On master: Close
[0m13:40:07.224194 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_completed_activities
[0m13:40:07.224358 [info ] [Thread-1 (]: 1 of 2 START sql table model public_pipedrive_analytics.int_completed_activities  [RUN]
[0m13:40:07.224584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.int_completed_activities)
[0m13:40:07.224695 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_completed_activities
[0m13:40:07.227320 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.227631 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_completed_activities
[0m13:40:07.238964 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.239256 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.239385 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp"
  
  
    as
  
  (
    

with activity as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity"
),

activity_types as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity_types"
),

deal_changes as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

final as (
    select
        a.activity_id,
        a.deal_id,
        a.activity_type_key,
        at.activity_type_name,
        a.user_id,
        a.is_completed,
        a.due_timestamp,
        dc.created_at as deal_created_at
    from activity a
    left join activity_types at on a.activity_type_key = at.activity_type_key
    left join deal_changes dc on a.deal_id = dc.deal_id
    where a.is_completed = true  -- Only completed activities
)

select * from final
  );
  
[0m13:40:07.239507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:07.257541 [debug] [Thread-1 (]: SQL status: SELECT 2290 in 0.018 seconds
[0m13:40:07.260440 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.260563 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
alter table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp" rename to "int_completed_activities"
[0m13:40:07.261114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:40:07.265244 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:40:07.265355 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.265453 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:40:07.267110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:40:07.268843 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup"
[0m13:40:07.270952 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:40:07.271072 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup" cascade
[0m13:40:07.271463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:40:07.272164 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: Close
[0m13:40:07.272838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26a250>]}
[0m13:40:07.273061 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public_pipedrive_analytics.int_completed_activities  [[32mSELECT 2290[0m in 0.05s]
[0m13:40:07.273242 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_completed_activities
[0m13:40:07.273363 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_stage_history
[0m13:40:07.273539 [info ] [Thread-1 (]: 2 of 2 START sql table model public_pipedrive_analytics.int_deal_stage_history . [RUN]
[0m13:40:07.273676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_completed_activities, now model.enpal_assessment_project.int_deal_stage_history)
[0m13:40:07.273776 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_stage_history
[0m13:40:07.275350 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.275574 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_stage_history
[0m13:40:07.276650 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.276851 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.276973 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp"
  
  
    as
  
  (
    

with deal_stages as (
    select
        deal_id,
        field_key,
        new_value as stage_id,
        change_timestamp,
        row_number() over (partition by deal_id, new_value order by change_timestamp) as stage_entry_num
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'stage_id'
),

deal_creation as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

stages as (
    select * from "postgres"."public_pipedrive_analytics"."stg_stages"
),

final as (
    select
        ds.deal_id,
        cast(ds.stage_id as integer) as stage_id,
        s.stage_name,
        ds.change_timestamp as stage_entry_timestamp,
        dc.created_at as deal_created_at,
        ds.stage_entry_num
    from deal_stages ds
    left join stages s on cast(ds.stage_id as integer) = s.stage_id
    left join deal_creation dc on ds.deal_id = dc.deal_id
    where ds.stage_entry_num = 1  -- Only first entry to each stage
)

select * from final
  );
  
[0m13:40:07.277088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:07.300907 [debug] [Thread-1 (]: SQL status: SELECT 8922 in 0.024 seconds
[0m13:40:07.302042 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.302171 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp" rename to "int_deal_stage_history"
[0m13:40:07.302612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:40:07.303065 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:40:07.303184 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.303291 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:40:07.304939 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:40:07.305810 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup"
[0m13:40:07.306052 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:40:07.306171 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup" cascade
[0m13:40:07.306520 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:40:07.306946 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: Close
[0m13:40:07.307151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227d17f5-0bc8-45c3-9011-defdf98d2226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b6790>]}
[0m13:40:07.307369 [info ] [Thread-1 (]: 2 of 2 OK created sql table model public_pipedrive_analytics.int_deal_stage_history  [[32mSELECT 8922[0m in 0.03s]
[0m13:40:07.307552 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_stage_history
[0m13:40:07.307950 [debug] [MainThread]: On master: COMMIT
[0m13:40:07.308056 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:07.308140 [debug] [MainThread]: On master: COMMIT
[0m13:40:07.308216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:07.312550 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:40:07.312667 [debug] [MainThread]: On master: Close
[0m13:40:07.312793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:07.312881 [debug] [MainThread]: Connection 'model.enpal_assessment_project.int_deal_stage_history' was properly closed.
[0m13:40:07.313000 [info ] [MainThread]: 
[0m13:40:07.313103 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:40:07.313355 [debug] [MainThread]: Command end result
[0m13:40:07.322097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:40:07.322817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:40:07.325115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:40:07.325222 [info ] [MainThread]: 
[0m13:40:07.325349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:07.325435 [info ] [MainThread]: 
[0m13:40:07.325534 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:40:07.326985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48766813, "process_in_blocks": "0", "process_kernel_time": 0.139579, "process_mem_max_rss": "143900672", "process_out_blocks": "0", "process_user_time": 0.713562}
[0m13:40:07.327135 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:07.327105 after 0.49 seconds
[0m13:40:07.327263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e053dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e053250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d22110>]}
[0m13:40:07.327377 [debug] [MainThread]: Flushing usage events
[0m13:40:08.017563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:38.640931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10966a650>]}


============================== 13:40:38.642656 | 65855c6b-3ab8-4632-bfeb-b99d2b0c2205 ==============================
[0m13:40:38.642656 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:40:38.642876 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'invocation_command': 'dbt run --select rep_sales_funnel_monthly', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m13:40:38.692542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c77890>]}
[0m13:40:38.709136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a556d0>]}
[0m13:40:38.709561 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:40:38.744951 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:40:38.785680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:38.785823 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:40:38.785911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:38.796354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6a13d0>]}
[0m13:40:38.818059 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:40:38.818704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:40:38.826409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a77ec90>]}
[0m13:40:38.826564 [info ] [MainThread]: Found 9 models, 6 sources, 464 macros
[0m13:40:38.826679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a491b10>]}
[0m13:40:38.827184 [info ] [MainThread]: 
[0m13:40:38.827304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:38.827399 [info ] [MainThread]: 
[0m13:40:38.827561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:38.827825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:40:38.862244 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:40:38.862377 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:40:38.862464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:38.884503 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:40:38.884931 [debug] [ThreadPool]: On list_postgres: Close
[0m13:40:38.886375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:40:38.888222 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:40:38.888342 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:40:38.888433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:38.896219 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m13:40:38.896654 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:40:38.896962 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:40:38.898739 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:38.898894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:40:38.899015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:38.906246 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m13:40:38.906607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b9610>]}
[0m13:40:38.906752 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:38.907019 [debug] [MainThread]: On master: COMMIT
[0m13:40:38.907103 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:38.907177 [debug] [MainThread]: On master: COMMIT
[0m13:40:38.907592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:38.907676 [debug] [MainThread]: On master: Close
[0m13:40:38.908665 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:40:38.908819 [info ] [Thread-1 (]: 1 of 1 START sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m13:40:38.908967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m13:40:38.909074 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:40:38.911561 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.911839 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:40:38.923051 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.923318 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.923482 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

with deal_stage_history as (
    select * from "postgres"."public_pipedrive_analytics"."int_deal_stage_history"
),

completed_activities as (
    select * from "postgres"."public_pipedrive_analytics"."int_completed_activities"
),

-- Map stages to funnel steps
stage_funnel as (
    select
        deal_id,
        stage_id,
        stage_name,
        stage_entry_timestamp,
        date_trunc('month', stage_entry_timestamp)::date as month,
        case 
            when stage_id = 1 then 'Step 1: Lead Generation'
            when stage_id = 2 then 'Step 2: Qualified Lead'
            when stage_id = 3 then 'Step 3: Needs Assessment'
            when stage_id = 4 then 'Step 4: Proposal/Quote Preparation'
            when stage_id = 5 then 'Step 5: Negotiation'
            when stage_id = 6 then 'Step 6: Closing'
            when stage_id = 7 then 'Step 7: Implementation/Onboarding'
            when stage_id = 8 then 'Step 8: Follow-up/Customer Success'
            when stage_id = 9 then 'Step 9: Renewal/Expansion'
        end as kpi_name,
        case 
            when stage_id = 1 then 1
            when stage_id = 2 then 2
            when stage_id = 3 then 3
            when stage_id = 4 then 4
            when stage_id = 5 then 5
            when stage_id = 6 then 6
            when stage_id = 7 then 7
            when stage_id = 8 then 8
            when stage_id = 9 then 9
        end as funnel_step
    from deal_stage_history
),

-- Map completed activities to funnel steps (sub-steps)
activity_funnel as (
    select
        deal_id,
        activity_type_name,
        due_timestamp,
        date_trunc('month', due_timestamp)::date as month,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 'Step 2.1: Sales Call 1'
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 'Step 3.1: Sales Call 2'
        end as kpi_name,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 2.1
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 3.1
        end as funnel_step
    from completed_activities
    where activity_type_key in ('meeting', 'sc_2')
    and activity_type_name in ('Sales Call 1', 'Sales Call 2')
),

-- Union stage and activity funnel
combined_funnel as (
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from stage_funnel
    where kpi_name is not null
    
    union all
    
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from activity_funnel
    where kpi_name is not null
),

-- Aggregate by month and funnel step
final as (
    select
        month,
        kpi_name,
        funnel_step,
        count(distinct deal_id) as deals_count
    from combined_funnel
    group by month, kpi_name, funnel_step
)

select * from final
order by month, funnel_step
  );
  
[0m13:40:38.923640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:38.948480 [debug] [Thread-1 (]: SQL status: SELECT 128 in 0.025 seconds
[0m13:40:38.951741 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.951871 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m13:40:38.952266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:40:38.956813 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:40:38.956935 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.957042 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:40:38.957714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:40:38.959668 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m13:40:38.961566 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:40:38.961702 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m13:40:38.962081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:40:38.962900 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m13:40:38.963606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65855c6b-3ab8-4632-bfeb-b99d2b0c2205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaedf10>]}
[0m13:40:38.963855 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 128[0m in 0.05s]
[0m13:40:38.964043 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:40:38.964418 [debug] [MainThread]: On master: COMMIT
[0m13:40:38.964522 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:38.964605 [debug] [MainThread]: On master: COMMIT
[0m13:40:38.964683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:38.968760 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:40:38.968864 [debug] [MainThread]: On master: Close
[0m13:40:38.968981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:38.969063 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m13:40:38.969159 [info ] [MainThread]: 
[0m13:40:38.969257 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m13:40:38.969456 [debug] [MainThread]: Command end result
[0m13:40:38.977779 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:40:38.978481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:40:38.980319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:40:38.980429 [info ] [MainThread]: 
[0m13:40:38.980562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:38.980649 [info ] [MainThread]: 
[0m13:40:38.980750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:40:38.982215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36323434, "process_in_blocks": "0", "process_kernel_time": 0.118464, "process_mem_max_rss": "140443648", "process_out_blocks": "0", "process_user_time": 0.646358}
[0m13:40:38.982348 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:38.982324 after 0.36 seconds
[0m13:40:38.982466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1005ba150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100672590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100673350>]}
[0m13:40:38.982577 [debug] [MainThread]: Flushing usage events
[0m13:40:39.534858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:19.266005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d959e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95a550>]}


============================== 13:46:19.267922 | 0199849e-ed99-4a6b-99e6-9e2cdf401b18 ==============================
[0m13:46:19.267922 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:46:19.268144 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'partial_parse': 'True', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m13:46:19.325130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cbcd0>]}
[0m13:46:19.341835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad7f850>]}
[0m13:46:19.342256 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:46:19.378989 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:46:19.420353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:19.420489 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:46:19.420571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:19.430917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8d3510>]}
[0m13:46:19.452426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:46:19.453369 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:19.461161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb1e850>]}
[0m13:46:19.461334 [info ] [MainThread]: Found 9 models, 6 sources, 464 macros
[0m13:46:19.461443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaed750>]}
[0m13:46:19.462112 [info ] [MainThread]: 
[0m13:46:19.462221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:19.462300 [info ] [MainThread]: 
[0m13:46:19.462455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:19.463768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:46:19.499329 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:46:19.499468 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:46:19.499551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:19.524927 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m13:46:19.525375 [debug] [ThreadPool]: On list_postgres: Close
[0m13:46:19.525899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:46:19.527784 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:46:19.527896 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:46:19.527986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:19.536771 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.009 seconds
[0m13:46:19.537219 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:46:19.537544 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:46:19.539364 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.539504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:46:19.539622 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:19.547168 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m13:46:19.547530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb3e810>]}
[0m13:46:19.547671 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:19.547944 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.548027 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.548098 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.548541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:46:19.548623 [debug] [MainThread]: On master: Close
[0m13:46:19.549627 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m13:46:19.549772 [info ] [Thread-1 (]: 1 of 9 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m13:46:19.549915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m13:46:19.550016 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:46:19.552427 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:46:19.552789 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:46:19.562938 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:46:19.563176 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:46:19.563293 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity"
),

renamed as (
    select
        -- rename and transform columns here
        activity_id,
        type as activity_type_key,
        assigned_to_user as user_id,
        deal_id,
        -- convert 'True'/'False' strings to boolean
        case 
            when done = 'True' then true
            when done = 'False' then false
            else null
        end as is_completed,
        cast(due_to as timestamp) as due_timestamp
    from source
)

select * from renamed
  );
[0m13:46:19.563403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.573495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:46:19.575360 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:46:19.575475 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:46:19.576007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.576873 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:46:19.576972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:46:19.577436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.581996 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:46:19.582114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:46:19.582208 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:46:19.583191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.585128 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m13:46:19.587110 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:46:19.587229 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m13:46:19.589710 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:46:19.590407 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m13:46:19.591042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5be850>]}
[0m13:46:19.591243 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.04s]
[0m13:46:19.591419 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:46:19.591535 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m13:46:19.591706 [info ] [Thread-1 (]: 2 of 9 START sql view model public_pipedrive_analytics.stg_activity_types ...... [RUN]
[0m13:46:19.591845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m13:46:19.591946 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m13:46:19.592882 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.593235 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m13:46:19.594314 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.594519 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.594627 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity_types"
),

renamed as (
    select
        id as activity_type_id,
        name as activity_type_name,
        case 
            when active = 'Yes' then true
            when active = 'No' then false
            else null
        end as is_active,
        type as activity_type_key
    from source
)

select * from renamed
  );
[0m13:46:19.594732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.603936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:46:19.604908 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.605015 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m13:46:19.605594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.606452 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.606557 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m13:46:19.607149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.607554 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:46:19.607657 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.607745 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:46:19.608656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.609358 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m13:46:19.609549 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:46:19.609659 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m13:46:19.611284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:46:19.611613 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m13:46:19.611775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef353d0>]}
[0m13:46:19.611953 [info ] [Thread-1 (]: 2 of 9 OK created sql view model public_pipedrive_analytics.stg_activity_types . [[32mCREATE VIEW[0m in 0.02s]
[0m13:46:19.612125 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m13:46:19.612240 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:46:19.612368 [info ] [Thread-1 (]: 3 of 9 START sql view model public_pipedrive_analytics.stg_deal_changes ........ [RUN]
[0m13:46:19.612529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:46:19.612655 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:46:19.613578 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.613803 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:46:19.614929 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.615146 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.615262 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."deal_changes"
),

renamed as (
    select
        deal_id,
        cast(change_time as timestamp) as change_timestamp,
        changed_field_key as field_key,
        new_value
    from source
)

select * from renamed
  );
[0m13:46:19.615366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.623903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:46:19.624864 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.624973 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m13:46:19.625473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.626306 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.626416 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:46:19.626963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.627359 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:46:19.627458 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.627544 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:46:19.628390 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.629119 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m13:46:19.629330 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:46:19.629439 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m13:46:19.630666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:46:19.631024 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:46:19.631195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef353d0>]}
[0m13:46:19.631389 [info ] [Thread-1 (]: 3 of 9 OK created sql view model public_pipedrive_analytics.stg_deal_changes ... [[32mCREATE VIEW[0m in 0.02s]
[0m13:46:19.631582 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:46:19.631713 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m13:46:19.631900 [info ] [Thread-1 (]: 4 of 9 START sql view model public_pipedrive_analytics.stg_stages .............. [RUN]
[0m13:46:19.632082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m13:46:19.632203 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m13:46:19.633918 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m13:46:19.634145 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m13:46:19.635322 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m13:46:19.635524 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:46:19.635637 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."stages"
),

renamed as (
    select
        stage_id,
        stage_name
    from source
)

select * from renamed
  );
[0m13:46:19.635745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.644936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:46:19.645911 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:46:19.646025 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m13:46:19.646851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:19.647745 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:46:19.647854 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m13:46:19.648627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:19.649047 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:46:19.649156 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:46:19.649253 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:46:19.650295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.651030 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m13:46:19.651241 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:46:19.651349 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m13:46:19.653267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:46:19.653624 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m13:46:19.653785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efa7110>]}
[0m13:46:19.653976 [info ] [Thread-1 (]: 4 of 9 OK created sql view model public_pipedrive_analytics.stg_stages ......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:46:19.654145 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m13:46:19.654261 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m13:46:19.654440 [info ] [Thread-1 (]: 5 of 9 START sql view model public_pipedrive_analytics.stg_users ............... [RUN]
[0m13:46:19.654621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m13:46:19.654740 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m13:46:19.655744 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m13:46:19.655939 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m13:46:19.657061 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m13:46:19.657255 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:46:19.657368 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."users"
),

renamed as (
    select
        id as user_id,
        name as user_name,
        email as user_email,
        cast(modified as timestamp) as modified_timestamp
    from source
)

select * from renamed
  );
[0m13:46:19.657478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.666739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:46:19.667739 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:46:19.667856 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m13:46:19.668419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.669306 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:46:19.669418 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:46:19.669949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.670400 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:46:19.670509 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:46:19.670604 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:46:19.671651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.672379 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m13:46:19.672586 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:46:19.672693 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m13:46:19.673518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:46:19.673876 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m13:46:19.674037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef7f110>]}
[0m13:46:19.674228 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public_pipedrive_analytics.stg_users .......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:46:19.674395 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m13:46:19.674513 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.test_model
[0m13:46:19.674679 [info ] [Thread-1 (]: 6 of 9 START sql table model public_pipedrive_analytics.test_model ............. [RUN]
[0m13:46:19.674816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.test_model)
[0m13:46:19.674924 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.test_model
[0m13:46:19.676478 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.test_model"
[0m13:46:19.676673 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.test_model
[0m13:46:19.683644 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.test_model"
[0m13:46:19.683850 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:46:19.683953 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp"
  
  
    as
  
  (
    SELECT *
FROM "postgres"."public"."activity"
  );
  
[0m13:46:19.684048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.694660 [debug] [Thread-1 (]: SQL status: SELECT 4579 in 0.011 seconds
[0m13:46:19.696820 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:46:19.696937 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model" rename to "test_model__dbt_backup"
[0m13:46:19.697508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.698420 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:46:19.698532 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
alter table "postgres"."public_pipedrive_analytics"."test_model__dbt_tmp" rename to "test_model"
[0m13:46:19.698950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.699387 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:46:19.699499 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:46:19.699603 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: COMMIT
[0m13:46:19.701368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:46:19.702154 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."test_model__dbt_backup"
[0m13:46:19.703055 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.test_model"
[0m13:46:19.703174 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.test_model"} */
drop table if exists "postgres"."public_pipedrive_analytics"."test_model__dbt_backup" cascade
[0m13:46:19.705089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:46:19.705485 [debug] [Thread-1 (]: On model.enpal_assessment_project.test_model: Close
[0m13:46:19.705658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef84f10>]}
[0m13:46:19.705852 [info ] [Thread-1 (]: 6 of 9 OK created sql table model public_pipedrive_analytics.test_model ........ [[32mSELECT 4579[0m in 0.03s]
[0m13:46:19.706023 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.test_model
[0m13:46:19.706143 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_completed_activities
[0m13:46:19.706308 [info ] [Thread-1 (]: 7 of 9 START sql table model public_pipedrive_analytics.int_completed_activities  [RUN]
[0m13:46:19.706440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.test_model, now model.enpal_assessment_project.int_completed_activities)
[0m13:46:19.706549 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_completed_activities
[0m13:46:19.707692 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.707904 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_completed_activities
[0m13:46:19.709060 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.709249 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.709382 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp"
  
  
    as
  
  (
    

with activity as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity"
),

activity_types as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity_types"
),

deal_changes as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

final as (
    select
        a.activity_id,
        a.deal_id,
        a.activity_type_key,
        at.activity_type_name,
        a.user_id,
        a.is_completed,
        a.due_timestamp,
        dc.created_at as deal_created_at
    from activity a
    left join activity_types at on a.activity_type_key = at.activity_type_key
    left join deal_changes dc on a.deal_id = dc.deal_id
    where a.is_completed = true  -- Only completed activities
)

select * from final
  );
  
[0m13:46:19.709512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.723695 [debug] [Thread-1 (]: SQL status: SELECT 2290 in 0.014 seconds
[0m13:46:19.724790 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.724910 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
alter table "postgres"."public_pipedrive_analytics"."int_completed_activities" rename to "int_completed_activities__dbt_backup"
[0m13:46:19.725370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.726263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.726382 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
alter table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp" rename to "int_completed_activities"
[0m13:46:19.726792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.727235 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:46:19.727352 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.727456 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:46:19.728777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.729536 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup"
[0m13:46:19.729753 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:46:19.729866 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup" cascade
[0m13:46:19.730990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:46:19.731348 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: Close
[0m13:46:19.731513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee89890>]}
[0m13:46:19.731710 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public_pipedrive_analytics.int_completed_activities  [[32mSELECT 2290[0m in 0.03s]
[0m13:46:19.731884 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_completed_activities
[0m13:46:19.732008 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_stage_history
[0m13:46:19.732187 [info ] [Thread-1 (]: 8 of 9 START sql table model public_pipedrive_analytics.int_deal_stage_history . [RUN]
[0m13:46:19.732329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_completed_activities, now model.enpal_assessment_project.int_deal_stage_history)
[0m13:46:19.732442 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_stage_history
[0m13:46:19.734291 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.734495 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_stage_history
[0m13:46:19.735638 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.735833 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.735974 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp"
  
  
    as
  
  (
    

with deal_stages as (
    select
        deal_id,
        field_key,
        new_value as stage_id,
        change_timestamp,
        row_number() over (partition by deal_id, new_value order by change_timestamp) as stage_entry_num
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'stage_id'
),

deal_creation as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

stages as (
    select * from "postgres"."public_pipedrive_analytics"."stg_stages"
),

final as (
    select
        ds.deal_id,
        cast(ds.stage_id as integer) as stage_id,
        s.stage_name,
        ds.change_timestamp as stage_entry_timestamp,
        dc.created_at as deal_created_at,
        ds.stage_entry_num
    from deal_stages ds
    left join stages s on cast(ds.stage_id as integer) = s.stage_id
    left join deal_creation dc on ds.deal_id = dc.deal_id
    where ds.stage_entry_num = 1  -- Only first entry to each stage
)

select * from final
  );
  
[0m13:46:19.736102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.758234 [debug] [Thread-1 (]: SQL status: SELECT 8922 in 0.022 seconds
[0m13:46:19.759324 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.759484 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_stage_history" rename to "int_deal_stage_history__dbt_backup"
[0m13:46:19.759943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.760950 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.761075 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp" rename to "int_deal_stage_history"
[0m13:46:19.761449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.761910 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:46:19.762033 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.762150 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:46:19.763807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:46:19.764650 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup"
[0m13:46:19.764885 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:46:19.765007 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup" cascade
[0m13:46:19.765821 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:46:19.766239 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: Close
[0m13:46:19.766450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e027690>]}
[0m13:46:19.766693 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public_pipedrive_analytics.int_deal_stage_history  [[32mSELECT 8922[0m in 0.03s]
[0m13:46:19.766893 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_stage_history
[0m13:46:19.767183 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:46:19.767345 [info ] [Thread-1 (]: 9 of 9 START sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m13:46:19.767487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_stage_history, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m13:46:19.767610 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:46:19.768916 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.769148 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:46:19.770349 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.770558 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.770750 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

with deal_stage_history as (
    select * from "postgres"."public_pipedrive_analytics"."int_deal_stage_history"
),

completed_activities as (
    select * from "postgres"."public_pipedrive_analytics"."int_completed_activities"
),

-- Map stages to funnel steps
stage_funnel as (
    select
        deal_id,
        stage_id,
        stage_name,
        stage_entry_timestamp,
        date_trunc('month', stage_entry_timestamp)::date as month,
        case 
            when stage_id = 1 then 'Step 1: Lead Generation'
            when stage_id = 2 then 'Step 2: Qualified Lead'
            when stage_id = 3 then 'Step 3: Needs Assessment'
            when stage_id = 4 then 'Step 4: Proposal/Quote Preparation'
            when stage_id = 5 then 'Step 5: Negotiation'
            when stage_id = 6 then 'Step 6: Closing'
            when stage_id = 7 then 'Step 7: Implementation/Onboarding'
            when stage_id = 8 then 'Step 8: Follow-up/Customer Success'
            when stage_id = 9 then 'Step 9: Renewal/Expansion'
        end as kpi_name,
        case 
            when stage_id = 1 then 1
            when stage_id = 2 then 2
            when stage_id = 3 then 3
            when stage_id = 4 then 4
            when stage_id = 5 then 5
            when stage_id = 6 then 6
            when stage_id = 7 then 7
            when stage_id = 8 then 8
            when stage_id = 9 then 9
        end as funnel_step
    from deal_stage_history
),

-- Map completed activities to funnel steps (sub-steps)
activity_funnel as (
    select
        deal_id,
        activity_type_name,
        due_timestamp,
        date_trunc('month', due_timestamp)::date as month,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 'Step 2.1: Sales Call 1'
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 'Step 3.1: Sales Call 2'
        end as kpi_name,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 2.1
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 3.1
        end as funnel_step
    from completed_activities
    where activity_type_key in ('meeting', 'sc_2')
    and activity_type_name in ('Sales Call 1', 'Sales Call 2')
),

-- Union stage and activity funnel
combined_funnel as (
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from stage_funnel
    where kpi_name is not null
    
    union all
    
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from activity_funnel
    where kpi_name is not null
),

-- Aggregate by month and funnel step
final as (
    select
        month,
        kpi_name,
        funnel_step,
        count(distinct deal_id) as deals_count
    from combined_funnel
    group by month, kpi_name, funnel_step
)

select * from final
order by month, funnel_step
  );
  
[0m13:46:19.770940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:19.787444 [debug] [Thread-1 (]: SQL status: SELECT 128 in 0.016 seconds
[0m13:46:19.788820 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.788958 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m13:46:19.789348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.790384 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.790511 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m13:46:19.790857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:46:19.791381 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:46:19.791508 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.791626 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:46:19.792332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:46:19.793280 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m13:46:19.793534 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:46:19.793660 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m13:46:19.794450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:46:19.794879 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m13:46:19.795084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0199849e-ed99-4a6b-99e6-9e2cdf401b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eed6810>]}
[0m13:46:19.795321 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 128[0m in 0.03s]
[0m13:46:19.795517 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:46:19.796044 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.796157 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.796249 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.796339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:19.800722 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:46:19.800835 [debug] [MainThread]: On master: Close
[0m13:46:19.800971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:19.801067 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m13:46:19.801210 [info ] [MainThread]: 
[0m13:46:19.801326 [info ] [MainThread]: Finished running 4 table models, 5 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:46:19.801866 [debug] [MainThread]: Command end result
[0m13:46:19.811453 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:46:19.812059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:46:19.814238 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:46:19.814345 [info ] [MainThread]: 
[0m13:46:19.814465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:19.814559 [info ] [MainThread]: 
[0m13:46:19.814662 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m13:46:19.816141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5722523, "process_in_blocks": "0", "process_kernel_time": 0.137511, "process_mem_max_rss": "140935168", "process_out_blocks": "0", "process_user_time": 0.731679}
[0m13:46:19.816303 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:19.816273 after 0.57 seconds
[0m13:46:19.816444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8fc950>]}
[0m13:46:19.816579 [debug] [MainThread]: Flushing usage events
[0m13:46:20.587014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:16.267950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d765890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c9410>]}


============================== 13:49:16.269964 | 6c6014d6-3d94-4412-aca0-faf5903ded43 ==============================
[0m13:49:16.269964 [info ] [MainThread]: Running with dbt=1.11.2
[0m13:49:16.270196 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/kaleab/Desktop/dbt_enpal_assessment', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/Users/kaleab/Desktop/dbt_enpal_assessment/logs', 'version_check': 'True', 'static_parser': 'True'}
[0m13:49:16.329210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c78d0>]}
[0m13:49:16.345566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abd9b90>]}
[0m13:49:16.345986 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m13:49:16.382133 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m13:49:16.424093 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:49:16.424268 [debug] [MainThread]: Partial parsing: deleted file: enpal_assessment_project://models/test_model.sql
[0m13:49:16.447080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75e210>]}
[0m13:49:16.468503 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:49:16.469348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:49:16.477862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e914890>]}
[0m13:49:16.478025 [info ] [MainThread]: Found 8 models, 6 sources, 464 macros
[0m13:49:16.478134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f9110>]}
[0m13:49:16.478768 [info ] [MainThread]: 
[0m13:49:16.478883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:16.478963 [info ] [MainThread]: 
[0m13:49:16.479116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:16.480407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:49:16.515965 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:49:16.516099 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:49:16.516182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:16.543343 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m13:49:16.543802 [debug] [ThreadPool]: On list_postgres: Close
[0m13:49:16.544300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_pipedrive_analytics)
[0m13:49:16.546117 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_pipedrive_analytics"
[0m13:49:16.546223 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "list_postgres_public_pipedrive_analytics"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_pipedrive_analytics'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_pipedrive_analytics'
  
[0m13:49:16.546314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:16.554742 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m13:49:16.555165 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: ROLLBACK
[0m13:49:16.555509 [debug] [ThreadPool]: On list_postgres_public_pipedrive_analytics: Close
[0m13:49:16.557299 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:16.557449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:49:16.557569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:16.567046 [debug] [MainThread]: SQL status: SELECT 5 in 0.009 seconds
[0m13:49:16.567436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e97b750>]}
[0m13:49:16.567583 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:16.567887 [debug] [MainThread]: On master: COMMIT
[0m13:49:16.567974 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:16.568050 [debug] [MainThread]: On master: COMMIT
[0m13:49:16.568516 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:16.568600 [debug] [MainThread]: On master: Close
[0m13:49:16.569714 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity
[0m13:49:16.569866 [info ] [Thread-1 (]: 1 of 8 START sql view model public_pipedrive_analytics.stg_activity ............ [RUN]
[0m13:49:16.570009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public_pipedrive_analytics, now model.enpal_assessment_project.stg_activity)
[0m13:49:16.570117 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity
[0m13:49:16.572488 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity"
[0m13:49:16.572715 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity
[0m13:49:16.583539 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity"
[0m13:49:16.583843 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:49:16.583972 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity"
),

renamed as (
    select
        -- rename and transform columns here
        activity_id,
        type as activity_type_key,
        assigned_to_user as user_id,
        deal_id,
        -- convert 'True'/'False' strings to boolean
        case 
            when done = 'True' then true
            when done = 'False' then false
            else null
        end as is_completed,
        cast(due_to as timestamp) as due_timestamp
    from source
)

select * from renamed
  );
[0m13:49:16.584084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.594595 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:49:16.596538 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:49:16.596663 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity" rename to "stg_activity__dbt_backup"
[0m13:49:16.597236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.598128 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:49:16.598234 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity__dbt_tmp" rename to "stg_activity"
[0m13:49:16.598950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:16.603636 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:49:16.603756 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:49:16.603853 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: COMMIT
[0m13:49:16.605302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.607070 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup"
[0m13:49:16.608451 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity"
[0m13:49:16.608558 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity__dbt_backup" cascade
[0m13:49:16.610541 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:49:16.611268 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity: Close
[0m13:49:16.611931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec2fb10>]}
[0m13:49:16.612136 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public_pipedrive_analytics.stg_activity ....... [[32mCREATE VIEW[0m in 0.04s]
[0m13:49:16.612312 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity
[0m13:49:16.612430 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_activity_types
[0m13:49:16.612618 [info ] [Thread-1 (]: 2 of 8 START sql view model public_pipedrive_analytics.stg_activity_types ...... [RUN]
[0m13:49:16.612776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity, now model.enpal_assessment_project.stg_activity_types)
[0m13:49:16.612884 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_activity_types
[0m13:49:16.613829 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.614171 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_activity_types
[0m13:49:16.615295 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.615481 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.615593 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */

  create view "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."activity_types"
),

renamed as (
    select
        id as activity_type_id,
        name as activity_type_name,
        case 
            when active = 'Yes' then true
            when active = 'No' then false
            else null
        end as is_active,
        type as activity_type_key
    from source
)

select * from renamed
  );
[0m13:49:16.615696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.624645 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:49:16.625576 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.625681 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types" rename to "stg_activity_types__dbt_backup"
[0m13:49:16.626467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:16.627330 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.627452 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
alter table "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_tmp" rename to "stg_activity_types"
[0m13:49:16.628042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.628450 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:49:16.628555 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.628644 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: COMMIT
[0m13:49:16.629509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.630234 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup"
[0m13:49:16.630429 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_activity_types"
[0m13:49:16.630528 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_activity_types"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_activity_types__dbt_backup" cascade
[0m13:49:16.632058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:49:16.632395 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_activity_types: Close
[0m13:49:16.632552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e98ad10>]}
[0m13:49:16.632728 [info ] [Thread-1 (]: 2 of 8 OK created sql view model public_pipedrive_analytics.stg_activity_types . [[32mCREATE VIEW[0m in 0.02s]
[0m13:49:16.632894 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_activity_types
[0m13:49:16.633003 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_deal_changes
[0m13:49:16.633178 [info ] [Thread-1 (]: 3 of 8 START sql view model public_pipedrive_analytics.stg_deal_changes ........ [RUN]
[0m13:49:16.633322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_activity_types, now model.enpal_assessment_project.stg_deal_changes)
[0m13:49:16.633428 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_deal_changes
[0m13:49:16.634837 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.635040 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_deal_changes
[0m13:49:16.636089 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.636271 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.636374 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */

  create view "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."deal_changes"
),

renamed as (
    select
        deal_id,
        cast(change_time as timestamp) as change_timestamp,
        changed_field_key as field_key,
        new_value
    from source
)

select * from renamed
  );
[0m13:49:16.636472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.646289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:49:16.647211 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.647324 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes" rename to "stg_deal_changes__dbt_backup"
[0m13:49:16.648066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:16.648902 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.649003 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
alter table "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_tmp" rename to "stg_deal_changes"
[0m13:49:16.649546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.649939 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:49:16.650040 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.650129 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: COMMIT
[0m13:49:16.650962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.651654 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup"
[0m13:49:16.651851 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_deal_changes"
[0m13:49:16.651951 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_deal_changes"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_deal_changes__dbt_backup" cascade
[0m13:49:16.653266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:49:16.653599 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_deal_changes: Close
[0m13:49:16.653752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e987550>]}
[0m13:49:16.653926 [info ] [Thread-1 (]: 3 of 8 OK created sql view model public_pipedrive_analytics.stg_deal_changes ... [[32mCREATE VIEW[0m in 0.02s]
[0m13:49:16.654094 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_deal_changes
[0m13:49:16.654206 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_stages
[0m13:49:16.654338 [info ] [Thread-1 (]: 4 of 8 START sql view model public_pipedrive_analytics.stg_stages .............. [RUN]
[0m13:49:16.654533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_deal_changes, now model.enpal_assessment_project.stg_stages)
[0m13:49:16.654653 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_stages
[0m13:49:16.655518 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_stages"
[0m13:49:16.655691 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_stages
[0m13:49:16.656721 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_stages"
[0m13:49:16.656906 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:49:16.657010 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */

  create view "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."stages"
),

renamed as (
    select
        stage_id,
        stage_name
    from source
)

select * from renamed
  );
[0m13:49:16.657108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.666253 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:49:16.667173 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:49:16.667277 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages" rename to "stg_stages__dbt_backup"
[0m13:49:16.667785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.668696 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:49:16.668823 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
alter table "postgres"."public_pipedrive_analytics"."stg_stages__dbt_tmp" rename to "stg_stages"
[0m13:49:16.669407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.669864 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:49:16.669971 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:49:16.670066 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: COMMIT
[0m13:49:16.671483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.672255 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup"
[0m13:49:16.672468 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_stages"
[0m13:49:16.672573 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_stages"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_stages__dbt_backup" cascade
[0m13:49:16.674192 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:49:16.674551 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_stages: Close
[0m13:49:16.674713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec2e350>]}
[0m13:49:16.674899 [info ] [Thread-1 (]: 4 of 8 OK created sql view model public_pipedrive_analytics.stg_stages ......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:49:16.675062 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_stages
[0m13:49:16.675177 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.stg_users
[0m13:49:16.675352 [info ] [Thread-1 (]: 5 of 8 START sql view model public_pipedrive_analytics.stg_users ............... [RUN]
[0m13:49:16.675526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_stages, now model.enpal_assessment_project.stg_users)
[0m13:49:16.675647 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.stg_users
[0m13:49:16.677176 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.stg_users"
[0m13:49:16.677368 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.stg_users
[0m13:49:16.678457 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.stg_users"
[0m13:49:16.678642 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:49:16.678753 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */

  create view "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp"
    
    
  as (
    

with source as (
    select * from "postgres"."public"."users"
),

renamed as (
    select
        id as user_id,
        name as user_name,
        email as user_email,
        cast(modified as timestamp) as modified_timestamp
    from source
)

select * from renamed
  );
[0m13:49:16.678858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.687133 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:49:16.688101 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:49:16.688216 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users" rename to "stg_users__dbt_backup"
[0m13:49:16.688735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.689622 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:49:16.689738 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
alter table "postgres"."public_pipedrive_analytics"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:49:16.690204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.690630 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:49:16.690737 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:49:16.690833 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: COMMIT
[0m13:49:16.691452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.692229 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup"
[0m13:49:16.692432 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.stg_users"
[0m13:49:16.692538 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.stg_users"} */
drop view if exists "postgres"."public_pipedrive_analytics"."stg_users__dbt_backup" cascade
[0m13:49:16.693242 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:49:16.693619 [debug] [Thread-1 (]: On model.enpal_assessment_project.stg_users: Close
[0m13:49:16.693777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e456a10>]}
[0m13:49:16.693958 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public_pipedrive_analytics.stg_users .......... [[32mCREATE VIEW[0m in 0.02s]
[0m13:49:16.694125 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.stg_users
[0m13:49:16.694242 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_completed_activities
[0m13:49:16.694381 [info ] [Thread-1 (]: 6 of 8 START sql table model public_pipedrive_analytics.int_completed_activities  [RUN]
[0m13:49:16.694531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.stg_users, now model.enpal_assessment_project.int_completed_activities)
[0m13:49:16.694645 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_completed_activities
[0m13:49:16.695759 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.696220 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_completed_activities
[0m13:49:16.702948 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.703155 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.703279 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp"
  
  
    as
  
  (
    

with activity as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity"
),

activity_types as (
    select * from "postgres"."public_pipedrive_analytics"."stg_activity_types"
),

deal_changes as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

final as (
    select
        a.activity_id,
        a.deal_id,
        a.activity_type_key,
        at.activity_type_name,
        a.user_id,
        a.is_completed,
        a.due_timestamp,
        dc.created_at as deal_created_at
    from activity a
    left join activity_types at on a.activity_type_key = at.activity_type_key
    left join deal_changes dc on a.deal_id = dc.deal_id
    where a.is_completed = true  -- Only completed activities
)

select * from final
  );
  
[0m13:49:16.703393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.718176 [debug] [Thread-1 (]: SQL status: SELECT 2290 in 0.015 seconds
[0m13:49:16.720263 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.720381 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
alter table "postgres"."public_pipedrive_analytics"."int_completed_activities" rename to "int_completed_activities__dbt_backup"
[0m13:49:16.720779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.721684 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.721797 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
alter table "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_tmp" rename to "int_completed_activities"
[0m13:49:16.722183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.722601 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:49:16.722711 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.722808 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: COMMIT
[0m13:49:16.723848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.724605 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup"
[0m13:49:16.725486 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_completed_activities"
[0m13:49:16.725604 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_completed_activities"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_completed_activities__dbt_backup" cascade
[0m13:49:16.726863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:49:16.727225 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_completed_activities: Close
[0m13:49:16.727391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed36950>]}
[0m13:49:16.727583 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public_pipedrive_analytics.int_completed_activities  [[32mSELECT 2290[0m in 0.03s]
[0m13:49:16.727756 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_completed_activities
[0m13:49:16.727874 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.int_deal_stage_history
[0m13:49:16.728018 [info ] [Thread-1 (]: 7 of 8 START sql table model public_pipedrive_analytics.int_deal_stage_history . [RUN]
[0m13:49:16.728183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_completed_activities, now model.enpal_assessment_project.int_deal_stage_history)
[0m13:49:16.728304 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.int_deal_stage_history
[0m13:49:16.730049 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.730260 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.int_deal_stage_history
[0m13:49:16.731411 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.731776 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.731921 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp"
  
  
    as
  
  (
    

with deal_stages as (
    select
        deal_id,
        field_key,
        new_value as stage_id,
        change_timestamp,
        row_number() over (partition by deal_id, new_value order by change_timestamp) as stage_entry_num
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'stage_id'
),

deal_creation as (
    select
        deal_id,
        change_timestamp as created_at
    from "postgres"."public_pipedrive_analytics"."stg_deal_changes"
    where field_key = 'add_time'
),

stages as (
    select * from "postgres"."public_pipedrive_analytics"."stg_stages"
),

final as (
    select
        ds.deal_id,
        cast(ds.stage_id as integer) as stage_id,
        s.stage_name,
        ds.change_timestamp as stage_entry_timestamp,
        dc.created_at as deal_created_at,
        ds.stage_entry_num
    from deal_stages ds
    left join stages s on cast(ds.stage_id as integer) = s.stage_id
    left join deal_creation dc on ds.deal_id = dc.deal_id
    where ds.stage_entry_num = 1  -- Only first entry to each stage
)

select * from final
  );
  
[0m13:49:16.732050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.754928 [debug] [Thread-1 (]: SQL status: SELECT 8922 in 0.023 seconds
[0m13:49:16.756084 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.756212 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_stage_history" rename to "int_deal_stage_history__dbt_backup"
[0m13:49:16.756619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.757615 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.757737 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
alter table "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_tmp" rename to "int_deal_stage_history"
[0m13:49:16.758066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.758546 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:49:16.758669 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.758778 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: COMMIT
[0m13:49:16.760046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:16.760900 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup"
[0m13:49:16.761145 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.int_deal_stage_history"
[0m13:49:16.761274 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.int_deal_stage_history"} */
drop table if exists "postgres"."public_pipedrive_analytics"."int_deal_stage_history__dbt_backup" cascade
[0m13:49:16.762181 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:49:16.762688 [debug] [Thread-1 (]: On model.enpal_assessment_project.int_deal_stage_history: Close
[0m13:49:16.762900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed1dc90>]}
[0m13:49:16.763146 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public_pipedrive_analytics.int_deal_stage_history  [[32mSELECT 8922[0m in 0.03s]
[0m13:49:16.763338 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.int_deal_stage_history
[0m13:49:16.763626 [debug] [Thread-1 (]: Began running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:49:16.763840 [info ] [Thread-1 (]: 8 of 8 START sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [RUN]
[0m13:49:16.764004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.enpal_assessment_project.int_deal_stage_history, now model.enpal_assessment_project.rep_sales_funnel_monthly)
[0m13:49:16.764121 [debug] [Thread-1 (]: Began compiling node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:49:16.765492 [debug] [Thread-1 (]: Writing injected SQL for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.765742 [debug] [Thread-1 (]: Began executing node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:49:16.766989 [debug] [Thread-1 (]: Writing runtime sql for node "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.767203 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.767381 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */

  
    

  create  table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp"
  
  
    as
  
  (
    

with deal_stage_history as (
    select * from "postgres"."public_pipedrive_analytics"."int_deal_stage_history"
),

completed_activities as (
    select * from "postgres"."public_pipedrive_analytics"."int_completed_activities"
),

-- Map stages to funnel steps
stage_funnel as (
    select
        deal_id,
        stage_id,
        stage_name,
        stage_entry_timestamp,
        date_trunc('month', stage_entry_timestamp)::date as month,
        case 
            when stage_id = 1 then 'Step 1: Lead Generation'
            when stage_id = 2 then 'Step 2: Qualified Lead'
            when stage_id = 3 then 'Step 3: Needs Assessment'
            when stage_id = 4 then 'Step 4: Proposal/Quote Preparation'
            when stage_id = 5 then 'Step 5: Negotiation'
            when stage_id = 6 then 'Step 6: Closing'
            when stage_id = 7 then 'Step 7: Implementation/Onboarding'
            when stage_id = 8 then 'Step 8: Follow-up/Customer Success'
            when stage_id = 9 then 'Step 9: Renewal/Expansion'
        end as kpi_name,
        case 
            when stage_id = 1 then 1
            when stage_id = 2 then 2
            when stage_id = 3 then 3
            when stage_id = 4 then 4
            when stage_id = 5 then 5
            when stage_id = 6 then 6
            when stage_id = 7 then 7
            when stage_id = 8 then 8
            when stage_id = 9 then 9
        end as funnel_step
    from deal_stage_history
),

-- Map completed activities to funnel steps (sub-steps)
activity_funnel as (
    select
        deal_id,
        activity_type_name,
        due_timestamp,
        date_trunc('month', due_timestamp)::date as month,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 'Step 2.1: Sales Call 1'
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 'Step 3.1: Sales Call 2'
        end as kpi_name,
        case 
            when activity_type_key = 'meeting' and activity_type_name = 'Sales Call 1' then 2.1
            when activity_type_key = 'sc_2' and activity_type_name = 'Sales Call 2' then 3.1
        end as funnel_step
    from completed_activities
    where activity_type_key in ('meeting', 'sc_2')
    and activity_type_name in ('Sales Call 1', 'Sales Call 2')
),

-- Union stage and activity funnel
combined_funnel as (
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from stage_funnel
    where kpi_name is not null
    
    union all
    
    select
        month,
        kpi_name,
        funnel_step,
        deal_id
    from activity_funnel
    where kpi_name is not null
),

-- Aggregate by month and funnel step
final as (
    select
        month,
        kpi_name,
        funnel_step,
        count(distinct deal_id) as deals_count
    from combined_funnel
    group by month, kpi_name, funnel_step
)

select * from final
order by month, funnel_step
  );
  
[0m13:49:16.767554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:16.789335 [debug] [Thread-1 (]: SQL status: SELECT 128 in 0.022 seconds
[0m13:49:16.790579 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.790718 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly" rename to "rep_sales_funnel_monthly__dbt_backup"
[0m13:49:16.791088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.792114 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.792244 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
alter table "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_tmp" rename to "rep_sales_funnel_monthly"
[0m13:49:16.792606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:16.793192 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:49:16.793328 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.793445 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: COMMIT
[0m13:49:16.793936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m13:49:16.794834 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup"
[0m13:49:16.795078 [debug] [Thread-1 (]: Using postgres connection "model.enpal_assessment_project.rep_sales_funnel_monthly"
[0m13:49:16.795201 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "enpal_assessment_project", "target_name": "dev", "node_id": "model.enpal_assessment_project.rep_sales_funnel_monthly"} */
drop table if exists "postgres"."public_pipedrive_analytics"."rep_sales_funnel_monthly__dbt_backup" cascade
[0m13:49:16.795991 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:49:16.796442 [debug] [Thread-1 (]: On model.enpal_assessment_project.rep_sales_funnel_monthly: Close
[0m13:49:16.796645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6014d6-3d94-4412-aca0-faf5903ded43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75df90>]}
[0m13:49:16.796866 [info ] [Thread-1 (]: 8 of 8 OK created sql table model public_pipedrive_analytics.rep_sales_funnel_monthly  [[32mSELECT 128[0m in 0.03s]
[0m13:49:16.797100 [debug] [Thread-1 (]: Finished running node model.enpal_assessment_project.rep_sales_funnel_monthly
[0m13:49:16.797612 [debug] [MainThread]: On master: COMMIT
[0m13:49:16.797732 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:16.797827 [debug] [MainThread]: On master: COMMIT
[0m13:49:16.797913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:16.802145 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m13:49:16.802276 [debug] [MainThread]: On master: Close
[0m13:49:16.802423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:16.802521 [debug] [MainThread]: Connection 'model.enpal_assessment_project.rep_sales_funnel_monthly' was properly closed.
[0m13:49:16.802675 [info ] [MainThread]: 
[0m13:49:16.802796 [info ] [MainThread]: Finished running 3 table models, 5 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:49:16.803330 [debug] [MainThread]: Command end result
[0m13:49:16.812732 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/manifest.json
[0m13:49:16.813323 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kaleab/Desktop/dbt_enpal_assessment/target/semantic_manifest.json
[0m13:49:16.815820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kaleab/Desktop/dbt_enpal_assessment/target/run_results.json
[0m13:49:16.815924 [info ] [MainThread]: 
[0m13:49:16.816044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:16.816138 [info ] [MainThread]: 
[0m13:49:16.816235 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m13:49:16.817687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5731418, "process_in_blocks": "0", "process_kernel_time": 0.134244, "process_mem_max_rss": "141180928", "process_out_blocks": "0", "process_user_time": 0.734305}
[0m13:49:16.817845 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:16.817817 after 0.57 seconds
[0m13:49:16.817971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109793390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109793310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961a050>]}
[0m13:49:16.818087 [debug] [MainThread]: Flushing usage events
[0m13:49:17.899632 [debug] [MainThread]: An error was encountered while trying to flush usage events
